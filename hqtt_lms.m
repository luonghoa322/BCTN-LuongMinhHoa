clear all; close all;
X=[
4	4	4	4	4	4	4
4	5	4	3	3	4	4
4	4	4	4	4	4	4
4	4	4	4	3	3	4
4	4	3	4	4	4	3
3	3	2	3	3	3	3
5	5	5	5	5	5	5
4	4	4	4	4	4	4
5	5	1	5	5	5	5
4	4	4	4	4	4	4
5	5	5	5	5	5	5
4	4	4	4	4	4	4
4	4	4	4	3	3	4
4	4	3	4	4	4	3
3	3	2	3	3	3	3
5	5	5	5	5	5	5
4	4	4	4	4	4	4
5	5	1	5	5	5	5
4	4	4	4	4	4	4
4	4	4	4	4	4	4
5	5	5	5	5	5	5
4	4	4	4	4	4	4
4	4	4	4	3	3	4
4	4	3	4	4	4	3
3	3	2	3	3	3	3
5	5	5	5	5	5	5
5	5	5	5	5	5	5
4	4	4	4	4	4	4
5	5	1	5	5	5	5
4	4	4	4	4	4	4
5	5	5	5	5	5	5
4	4	4	4	4	4	4
4	4	4	4	3	3	4
4	4	3	4	4	4	3
3	3	2	3	3	3	3
5	5	5	5	5	5	5
4	4	4	4	4	4	4
5	5	1	5	5	5	5
4	4	4	4	4	4	4
4	4	4	4	4	4	4
4	5	4	3	3	4	4
4	4	4	4	4	4	4
4	4	4	4	3	3	4
4	4	3	4	4	4	3
3	3	2	3	3	3	3
5	5	5	5	5	5	5
4	4	4	4	4	4	4
5	5	1	5	5	5	5
4	4	4	4	4	4	4
5	5	5	5	5	5	5
4	4	4	4	4	4	4
4	4	4	4	3	3	4
4	4	3	4	4	4	3
3	3	2	3	3	3	3
4	4	4	4	4	4	4
4	5	4	3	3	4	4
4	4	4	4	4	4	4
4	4	4	4	3	3	4
4	4	3	4	4	4	3
3	3	2	3	3	3	3
5	5	5	5	5	5	5
4	4	4	4	4	4	4
5	5	1	5	5	5	5
4	4	4	4	4	4	4
5	5	5	5	5	5	5
4	4	4	4	4	4	4
4	4	4	4	3	3	4
4	4	3	4	4	4	3
3	3	2	3	3	3	3
5	5	5	5	5	5	5
4	4	4	4	4	4	4
5	5	1	5	5	5	5
4	4	4	4	4	4	4
4	4	4	4	4	4	4
5	5	5	5	5	5	5
4	4	4	4	4	4	4
4	4	4	4	3	3	4
4	4	3	4	4	4	3
3	3	2	3	3	3	3
5	5	5	5	5	5	5
5	5	5	5	5	5	5
4	4	4	4	4	4	4
5	5	1	5	5	5	5
4	4	4	4	4	4	4
5	5	5	5	5	5	5
4	4	4	4	4	4	4
4	4	4	4	3	3	4
4	4	3	4	4	4	3
3	3	2	3	3	3	3
5	5	5	5	5	5	5
4	4	4	4	4	4	4
5	5	1	5	5	5	5
4	4	4	4	4	4	4
4	4	4	4	4	4	4
4	5	4	3	3	4	4
4	4	4	4	4	4	4
4	4	4	4	3	3	4
4	4	3	4	4	4	3
3	3	2	3	3	3	3
5	5	5	5	5	5	5
4	4	4	4	4	4	4
5	5	1	5	5	5	5
4	4	4	4	4	4	4
5	5	5	5	5	5	5
4	4	4	4	4	4	4
4	4	4	4	3	3	4
4	4	3	4	4	4	3
3	3	2	3	3	3	3
5	5	1	5	5	5	5
4	4	4	4	4	4	4
5	5	5	5	5	5	5
4	4	4	4	4	4	4
4	4	4	4	3	3	4
4	4	3	4	4	4	3
3	3	2	3	3	3	3
];

XX(:,1)=X(:,2);
XX(:,2)=X(:,3);
XX(:,3)=X(:,4);
XX(:,4)=X(:,5);
XX(:,5)=X(:,7);
%XX(:,6)=X(:,7);

X=X';
XX=XX';
%y=[4 5 4 4 5 2 5 3 5 4 4 4 5 4 4 5 2 5 3 5 4 4 4 5 4 4 5 2 5 3 5 4 4 4 5 4 4 4 5 4 5 4 4 5 5 2 5 3 5 4 4 4 5 4 4 5 4 4 5 2 5 3 5 4 4 4 5 4 4 5 2 5 3 5 4 4 4 5 4 4 5 2 5 3 5 4 4 4 5 4 4 4 5 4 5 4 4 5 5 2 5 3 5 4 4 4 5 4 3 5 4 4 4 5 3];
y=[4 4 4 5 4 3 5 4 4 4 5 5 4 4 3 5 4 5 4 4 5 4 4 3 5 5 4 5 4 5 4 4 3 2 5 3 4 4 4 4 4 3 4 2 5 4 2 3 5 4 2 3 3 4 4 4 3 4 2 4 4 4 5 4 3 4 3 5 4 4 4 4 5 4 3 4 3 5 5 4 5 4 5 4 3 3 3 5 4 5 4 4 4 4 4 3 3 5 3 3 4 4 4 3 4 3 5 4 5 4 4 4 5 4 5];  
[r c]=size(X); 

mu=0.0001;
[d,sstbbpkc,WW ] = LMS( X,y,mu );

%subplot(2,1,1);plot(d);
%subplot(2,1,2);plot(sstbbpkc);

beta = [0.378 0.191 -0.122 0.453 0.095];
for k=1:115
    yy(k)=beta*XX(:,k);
end;

L=5;
for k=1:(length(y)-L-1)
    for m=1:L
        y1(1,m)=y(1,k+m);
        ymu(1,m)=yy(1,k+m);
    end;
    rmse_hqtt(k)=rmse( y1,ymu);
end;
    
figure,
subplot(2,1,1); plot(rmse_hqtt); title(' RMSE truong hop dung HQTT'); axis([1 115 0 4]); grid on;
subplot(2,1,2); plot(sstbbpkc); title('RMSE truong hop dung thuat toan LMS'); axis([1 115 0 4]); grid on;




